# GitHub Pages Deployment Plan for RegexBuilder.NET9

## Overview

This document outlines a comprehensive plan to deploy the RegexBuilder.NET9 documentation (generated by DocFX) to GitHub Pages, making it publicly accessible at `https://username.github.io/RegexBuilder.NET9/`.

## Current State

- **Project**: RegexBuilder.NET9
- **Repository**: [RegexBuilder.NET9](https://github.com/somenoe/RegexBuilder.NET9)
- **Current Branch**: `dev`
- **Documentation Tool**: DocFX
- **Documentation Location**: `docs/` (separate from source)
- **Build Output**: `docs/_site/`
- **Source Code**: `src/` (clean, no DocFX files)

## Deployment Strategy

### Option 1: GitHub Actions Workflow (Recommended)

Using GitHub Actions to automatically build and deploy documentation on every push/merge to main branch.

#### Step 1: Create GitHub Actions Workflow File

Create `.github/workflows/deploy-docs.yml`:

```yaml
name: Deploy DocFX Documentation

on:
  push:
    branches:
      - main
      - dev
  pull_request:
    branches:
      - main

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Setup .NET
        uses: actions/setup-dotnet@v3
        with:
          dotnet-version: "9.x"

      - name: Install DocFX
        run: dotnet tool install -g docfx

      - name: Build documentation
        working-directory: ./docs
        run: docfx docfx.json

      - name: Deploy to GitHub Pages
        if: github.event_name == 'push' && github.ref == 'refs/heads/main'
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./docs/_site
          cname: (optional - custom domain)
```

#### Step 2: Enable GitHub Pages in Repository Settings

1. Go to Repository Settings → Pages
2. Source: Deploy from a branch
3. Branch: `gh-pages` (auto-created by workflow)
4. Folder: `/root`
5. Save

#### Step 3: Customize Documentation

Before deploying:

- Update `docs/index.md` with project description
- Add guides to `docs/content/`
- Update `docs/docfx.json` with project metadata
- Ensure C# code has XML documentation comments

### Option 2: Manual Deployment

For manual control over deployment process:

#### Step 1: Build Documentation Locally

```powershell
cd src
docfx docfx.json
```

#### Step 2: Create gh-pages Branch (First Time Only)

```powershell
git checkout --orphan gh-pages
git rm -rf .
git commit --allow-empty -m "Initial commit for gh-pages"
git push origin gh-pages
git checkout dev
```

#### Step 3: Deploy Built Documentation

```powershell
# Build the site
cd docs
docfx docfx.json

# Copy built files to gh-pages branch
git worktree add temp-pages gh-pages
Copy-Item -Path "docs/_site/*" -Destination "temp-pages/" -Recurse -Force
cd temp-pages
git add .
git commit -m "docs: update documentation $(Get-Date -Format 'yyyy-MM-dd HH:mm')"
git push origin gh-pages
cd ..
git worktree remove temp-pages
```

## Implementation Checklist

### Phase 1: Preparation (Week 1)

- [ ] Review current DocFX setup
- [ ] Verify all C# code has proper XML documentation
- [ ] Update `src/docfx.json` with project metadata:
  - [ ] Set `_appName` to "RegexBuilder"
  - [ ] Set `_appTitle` to "RegexBuilder.NET9 API Documentation"
  - [ ] Configure branding and styling

- [ ] Create/Update documentation files:
  - [ ] `src/index.md` - project overview
  - [ ] `src/docs/introduction.md` - introduction
  - [ ] `src/docs/getting-started.md` - quick start guide
  - [ ] `src/docs/api-overview.md` - API overview
  - [ ] Add more guides as needed

- [ ] Create `.gitignore` entries:

```bash
# DocFX generated files
docs/_site/
docs/api/
docs/obj/
```

### Phase 2: Workflow Setup (Week 2)

- [ ] Create `.github/workflows/deploy-docs.yml`
- [ ] Test workflow locally with `act` tool (optional)
- [ ] Commit workflow file to repository
- [ ] Trigger initial workflow run

### Phase 3: Configuration (Week 2-3)

- [ ] Enable GitHub Pages in repository settings
- [ ] Verify `gh-pages` branch is created
- [ ] Check deployment status
- [ ] Access documentation at `https://somenoe.github.io/RegexBuilder.NET9/`

### Phase 4: Customization (Week 3-4)

- [ ] Add custom domain (if applicable)
- [ ] Customize CSS/styling in DocFX templates
- [ ] Add analytics (Google Analytics optional)
- [ ] Add breadcrumb navigation
- [ ] Test on multiple browsers

### Phase 5: CI/CD Enhancement (Week 4-5)

- [ ] Add link validation to workflow
- [ ] Add spell-checking to CI
- [ ] Set up notifications for deployment failures
- [ ] Add documentation build to PR checks
- [ ] Require documentation review before merge

## File Structure After Setup

```bash
RegexBuilder.NET9/
├── .github/
│   └── workflows/
│       └── deploy-docs.yml          # GitHub Actions workflow
├── .gitignore                        # Updated with DocFX outputs
├── docs/
│   ├── docfx.json                   # DocFX configuration
│   ├── index.md                      # Home page
│   ├── toc.yml                       # Main TOC
│   ├── _site/                        # Generated docs (ignored)
│   ├── api/                          # Generated API docs (ignored)
│   └── content/
│       ├── toc.yml
│       ├── introduction.md
│       ├── getting-started.md
│       └── guides/                   # Additional guides
├── src/                              # Source code (clean)
│   └── RegexBuilder/                 # No DocFX files here
└── ...
```

## docfx.json Configuration Template

```json
{
  "$schema": "https://raw.githubusercontent.com/dotnet/docfx/main/schemas/docfx.schema.json",
  "metadata": [
    {
      "src": [
        {
          "src": "../src",
          "files": ["**/*.csproj"]
        }
      ],
      "dest": "api",
      "disableGitFeatures": false,
      "includePrivateMembers": false,
      "includeSealedMembers": false
    }
  ],
  "build": {
    "content": [
      {
        "files": ["**/*.{md,yml}"],
        "exclude": ["_site/**"]
      }
    ],
    "resource": [
      {
        "files": ["images/**"]
      }
    ],
    "output": "_site",
    "template": ["default", "modern"],
    "globalMetadata": {
      "_appName": "RegexBuilder",
      "_appTitle": "RegexBuilder.NET9 - Fluent Regex Builder",
      "_appLogoPath": "images/logo.png",
      "_appFaviconPath": "images/favicon.ico",
      "_enableSearch": true,
      "_enableNewTab": true,
      "pdf": true,
      "lang": "en-us"
    },
    "dest": "_site"
  }
}
```

## GitHub Actions Workflow Benefits

1. **Automatic Builds**: Documentation builds on every push/PR
2. **Quality Gates**: Can add checks to prevent broken links
3. **Atomic Deployments**: All or nothing deployment strategy
4. **History Tracking**: Full git history of documentation changes
5. **Easy Rollback**: Can revert to previous documentation versions
6. **No Manual Steps**: Developers don't need to remember build commands

## Monitoring and Maintenance

### Post-Deployment Tasks

- [ ] Monitor GitHub Actions workflow runs
- [ ] Set up Slack/email notifications for failures
- [ ] Track documentation page views (optional)
- [ ] Collect user feedback on documentation
- [ ] Schedule quarterly documentation reviews

### Ongoing Maintenance

1. **Weekly**: Review PR documentation changes
2. **Monthly**: Audit links and verify no broken references
3. **Quarterly**: Update getting started guides with new features
4. **Annually**: Major documentation restructuring if needed

## Rollback Procedure

If documentation deployment fails:

1. Check GitHub Actions workflow logs
2. Identify the issue (usually build failure)
3. Fix the issue in source branch
4. Commit and push to trigger new workflow
5. Workflow will automatically redeploy

For manual rollback:

```powershell
git checkout gh-pages~1
git push origin gh-pages --force
git checkout dev
```

## Performance Optimization

- Use DocFX caching to speed up builds
- Enable gzip compression in GitHub Pages
- Minimize images before adding to `images/` folder
- Use relative URLs in markdown files

## Security Considerations

- Keep DocFX tool updated: `dotnet tool update -g docfx`
- Never commit sensitive information in documentation
- Use GitHub secrets for any credentials in workflows
- Validate all external links in documentation
- Use HTTPS for custom domains

## Additional Resources

- [GitHub Pages Documentation](https://docs.github.com/en/pages)
- [DocFX Documentation](https://dotnet.github.io/docfx/)
- [GitHub Actions Documentation](https://docs.github.com/en/actions)
- [peaceiris/actions-gh-pages](https://github.com/peaceiris/actions-gh-pages)

## Timeline Estimate

- **Preparation**: 5-10 hours
- **Workflow Setup**: 2-3 hours
- **Testing & Debugging**: 3-5 hours
- **Customization**: 5-10 hours
- **Total**: 15-28 hours (1-2 weeks depending on scope)

## Next Steps

1. Review this plan with team
2. Get approval to proceed
3. Create branch for documentation work
4. Start with Phase 1 (Preparation)
5. Follow up with other phases in sequence
